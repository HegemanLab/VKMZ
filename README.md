# vkmz version 1.0 

vkmz is a metabolomics vizualization tool which creates van Krevelen diagrams (VKD) from mass spectrometry data.

This program is based on [OpenVanKrevelen](https://github.com/HegemanLab/VanKrevelenLocal) [0].

## Using vkmz

### Input modes

vkmz has three input modes:
  1. `xcms` mode takes a tabular representation of the [XCMS](https://bioconductor.org/packages/release/bioc/html/xcms.html) [1] datamatrix
  2. `tsv` mode takes a specially formatted tabular file
  3. `plot` mode takes vkmz tabular data that was generated by a previous run of the tool

Select a mode by declaring it as the first argument to `vkmz.py`. *eg.*
```
python vkmz.py xcms [OTHER PARAMETERS]
```

Different modes take different parameters.

All modes require an output parameter:
  * `--output [FILENAME]`
    * A `.tsv` and/or `.html` will be generated by vkmz with this paraameter as the file name.

All modes allow these optioal parameters:
  * `--plot-type [{scatter-2d}]`
    * Select plot type
  * `--size [INTEGER]`
    * Set base size of marker dots of the VKD
  * `--size-algorithm [{1,2,3,}]`
    * Choose algorithm to modify marker size
      1. Uniform base size
      2. Relative feature log intensity

#### xcms and tsv modes

Both xcms and tsv mode require the mass error, in parts-per-million, of the mass spectrometer which generated the intial data:
  * `--error [INTEGER]`

There are several optional parameters for xcms and tsv modes:
  * `--database [DATABASE_FILE]`
    * default is BMRB's monoisotopic heuristically generated database [2]
  * `--directory [TOOL_PATH]`
    * define tool directory
  * `--multiprocessing`
    * Call parameter to enable multiprocessing
  * `--no-plot`
    * Disables html file generation

#### xcms mode

xcms mode required tabular files generated by XCMS:
  * `--data-matrix [XCMS_DATA_MATRIX_FILE]`
  * `--sample-metadata [XCMS_SAMPLE_METADATAFILE]`
  * `--variable-metadata [XCMS_VARIABLE_METADATAFILE]`

##### xcms mode example:
```
python vkmz.py xcms --data-matrix test-data/datamatrix.tabular --sample-metadata test-data/sampleMetadata.tabular --variable-metadata test-data/variableMetadata.tabular --output report --error 3
```

#### tsv mode

tsv mode requires a tabular file of a specific format as input.
  * `--input [TSV FILE]`

The first five columns of tabular input must be:

| sample ID | polarity | mz | retention time | intensity |
|-----------|----------|----|----------------|-----------|

#### plot mode

plot mode reads previously generated vkmz tabular files to create VKD html files. Specify the vkmz tabular with with:
  * `--input [VKMZ_TSV_FILE]`

## Citations

0. Brockman et al. [doi:10.1007/s11306-018-1343-y](https://doi.org/10.1007/s11306-018-1343-y)
1. Giacomoni et al. [doi:10.1093/bioinformatics/btu813](https://doi.org/10.1093/bioinformatics/btu813)
2. Hegeman et al. [doi:10.1021/ac070346t](https://doi.org/10.1021/ac070346t)
