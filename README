# vkmz version 1.0 

vkmz is a metabolomics vizualization tool which creates van Krevelen diagrams (VKD) from mass spectrometry data.

This program is based on [OpenVanKrevelen](https://github.com/HegemanLab/VanKrevelenLocal) [0].

## Using vkmz

### xcms, tsv, and plot mode

vkmz has three modes: (1) `xcms` which takes [XCMS](https://bioconductor.org/packages/release/bioc/html/xcms.html) [1], (2) `tsv` which takes a specially formatted tabular file, and (3) `plot` which plots previously generated VKD data.

Select a mode by declaring it as the first argument to `vkmz.py`. **eg.**
```
python vkmz.py xcms
```

Different modes take different parameters.

All modes require an output parameter:
  * `--output [FILENAME]`
    * A `.tsv` and/or `.html` will be generated by vkmz with this paraameter as the file name.

All modes allow these optioal parameters:
  * `--plottype [{scatter-2d, scatter-3d}]`
    * Select plot type
  * `--size [integer]`
    * Set base size of marker dot on the VKD
  * `--size-algorithm [{1,2,3,}]`
    * Choose algorithm to modify marker size
      1. The first algorithm sets all markers to the base size
      2. Set marker size based on relative intensity
      3. Undefined

### xcms and tsv mode

Both xcms and tsv mode require the mass error, in parts-per-million, of the mass spectrometer which generated the intial data:
  * `--error [integer]`

There are several optional parameters for xcms and tsv modes:
  * `--database [DATABASE FILE]`
    * default is BMRB's monoisotopic heuristically generated database [2]
  * `--directory [TOOL PATH]`
    * define tool directory
  * `--multiprocessing`
    * Calling parameter to enable multiprocessing
  * `--no-plot`
    * Disables html file generation

### xcms mode

xcms mode has three required parameters for the tabular files generated by XCMS:
  * `--data-matrix [XCMS DATA MATRIX FILE]`
  * `--sample-metadata [XCMS SAMPLE METADATA FILE]`
  * `--variable-metadata [XCMS VARIABLE METADATA FILE]`

### tsv mode

tsv mode requires a tabular file of a specific format as input.
  * `--input [TSV FILE]`

The first five columns of tabular input must be: `sample ID, polarity, mz, retention time, intensity`

### plot mode

plot mode reads previously generated vkmz tabular files to create VKD html files. Specify the vkmz tabular with with:
  * `--input [VKMZ TSV FILE]

## Citations
[0] Brockman et. al doi: 10.1007/s11306-018-1343-y
[1] XCMS
[2] Hegeman et. al DOI: 10.1021/ac070346t
