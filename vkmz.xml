<tool id="vkmz" name="vkmz" version="alpha-0.1">

  <description>predict formulas and generate VK diagram</description>
  
  <requirements>
    <requirement type="package" version="2.7">python</requirement>
    <requirement type="package">pandas</requirement>
    <requirement type="package">plotly</requirement>
  </requirements>
  
  <stdio>
    <exit_code range="1:" level="fatal" />
  </stdio>

  <command detect_errors="aggressive"><![CDATA[
    python $__tool_directory__/vkmz.py
      xcms
      --data-matrix $datamatrix
      --sample-metadata $samplemetadata
      --variable-metadata $variablemetadata
      --database $database
      --output vkmz
      --directory $__tool_directory__/;
  ]]></command>

  <inputs>
    <param name="datamatrix" label="XCMS Data Matrix" type="data" format="tabular" help="Select XCMS data matrix." />
    <param name="samplemetadata" label="XCMS Sample Metadata" type="data" format="tabular" help="Select XCMS sample metadata" />
    <param name="variablemetadata" label="XCMS Variable Metadata" type="data" format="tabular" help="Select XCMS variable metadata." />
    <param name="database" label="Database" type="select" help="Choose database of known formula masses.">
      <option value="databases/bmrb-light.tsv">Normal</option>
      <option value="databases/bmrb-heavy_carbon.tsv">Heavy Carbon</option>
      <option value="databases/bmrb-heavy_nitrogen.tsv">Heavy Nitrogen</option>
      <option value="databases/bmrb-heavy.tsv">Heavy Carbon and Nitrogen</option>
    </param>
  </inputs>

  <outputs>
    <data format="tabular" name="output" from_work_dir="vkmz.tsv" label="${tool.name}_${datamatrix.name}" />
    <data format="tabular" name="outputhtml" from_work_dir="vkmz.html" label="${tool.name}_${datamatrix.name}_html" />
  </outputs>

  <tests>
    <test>
      <param name="datamatrix" value="hazel-xd.tsv" />
      <param name="samplemetadata" value="hazel-xs.tsv" />
      <param name="variablemetadata" value="hazel-xv.tsv" />
      <param name="database" value="databases/bmrb-light.tsv" />
      <output name="output">
        <assert_contents>
          <has_text text="0.0740997586440244" />
        </assert_contents>
      </output>
    </test>
  </tests>

  <help><![CDATA[

**Authors** - Stephen Brockman (brock197@umn.edu)

**Authors** - Mark Esler (eslerm@umn.edu)

Release notes
-------------

beta-0.01

  ]]></help>

  <citations>
    <citation type="doi">123.456/example.123</citation>
    <!-- Example Title -->
  </citations>

</tool>
